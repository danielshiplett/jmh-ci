key_map:
  "/{ns2actual}Top/{ns2actual}Top2/{ns2actual}TopMeta2/{defaultactual}Address": "//ADDRESS"
  "/{ns2actual}Top/{ns2actual}Top2/{ns2actual}InnerTop/{ns29actual}cpeResultItem/{ns29actual}result/{ns29actual}record/@record_identifier": "//RID"
  "/{ns2actual}Top/{ns2actual}Top2/{ns2actual}TopMeta2/{defaultactual}Time": "//TS_START"
  
timestamp_key: "//TS_START"

visibility_map:
  "splitkey1": "U"
  "/{ns2actual}Top/{ns2actual}Top2/{ns2actual}InnerTop/{ns29actual}RP": "FOUO"

extra_processing:
  - class: "c3.ingest.parsers.utils.SplitValueTransform"
    input_keys: 
      - "/{ns2actual}Top/{ns2actual}Top2/{ns2actual}TopMeta2/{defaultactual}InnerMeta2/{ns16actual}InnerMetaWAttr/@value"
    output_keys:
      - "splitkey1"
      - "splitkey2"
      - "splitkey3"
      - "splitkey4"
      - "splitkey5"
    split_char: "."
    keep_originals: true
  - class: "c3.ingest.parsers.utils.ConcatenateTransform"
    input_keys: 
      - "/{ns2actual}Top/{ns2actual}Top2/{ns2actual}InnerTop/{ns29actual}RP"
      - "/{ns2actual}Top/{ns2actual}Top2/{ns2actual}InnerTop/{ns29actual}RP/@RPattr"
    output_keys:
      - "newATTR"
    concat_char: "_"
    keep_originals: true